{"version":3,"sources":["entry.ts"],"names":[],"mappings":"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","file":"entry.js","sourcesContent":["/// <reference path=\"../typings/d3/d3.d.ts\" />\n/// <reference path=\"../typings/es6-promise/es6-promise.d.ts\"/>\n/// <reference path=\"../typings/requirejs/require.d.ts\"/>\n/// <reference path=\"../Shared/InMemoryBrowserUsers.ts\"/>\n/// <reference path=\"../Shared/UserConstructor.ts\"/>\nrequirejs.config( {\n    baseUrl : '/'\n});\n\nvar users;\n\nrequire(['Shared/InMemoryBrowserUsers', 'Shared/UserConstructor'], function(u, c) {\n    users = new u.InMemoryBrowserUsers(window);\n    \n    class UIEntry {\n        constructor() {\n            document.getElementById('new').addEventListener(\"mousedown\", () => {\n                UI.ClearUsers();\n            });\n            document.getElementById('user').addEventListener(\"keyup\", (e:KeyboardEvent) => {\n                var code = e.keyCode;\n                if(code === 13) {\n                    AddUser();\n                }\n            });\n            document.getElementById('add').addEventListener(\"mousedown\", () => {\n                AddUser();\n            });     \n        }\n\n        AddUser(username) {\n            \n            var textNode = document.createElement(\"span\");\n            textNode.setAttribute(\"class\", \"user\");\n            textNode.textContent = username;\n\n            var deleteButton = document.createElement(\"a\");\n            deleteButton.setAttribute(\"href\", \"void(0);\");\n            deleteButton.textContent = \"X\";\n            deleteButton.addEventListener(\"mousedown\", (e:MouseEvent) => {\n                var el = (<Element>e.target).parentNode;\n                this.ClearUser(el.textContent);\n                \n                var usernames = UI.GetUsers();\n                saveUsers(usernames);\n                        \n            });\n\n            var newNode = document.createElement(\"li\");\n            newNode.appendChild(textNode);\n            newNode.appendChild(deleteButton);\n\n            document.getElementById('users').appendChild(newNode);\n        }\n        ClearUser (username) {\n            var parent = document.getElementById('users');\n            var nodeList = parent.childNodes;\n            for (var i=nodeList.length;i--;i>0) {\n                if(username === nodeList[i].textContent) {\n                    document.getElementById('users').removeChild(nodeList[i]);\n                }  \n            }\n        }\n        ClearUsers () {\n            var parent = document.getElementById('users');\n            var nodeList = parent.childNodes;\n            for (var i=nodeList.length;i--;i>0){\n                document.getElementById('users').removeChild(nodeList[i]);\n            }\n        }\n        GetUsername () : string {\n            return (<HTMLInputElement>document.getElementById('user')).value;\n        }\n        ShowError (error) {\n            alert(error);\n        }\n        ClearUsername () {\n            (<HTMLInputElement>document.getElementById('user')).value = \"\";\n        }\n        FocusUsername () {\n            (<HTMLInputElement>document.getElementById('user')).focus();\n        }\n        GetUsers () : Array<string> {\n            var entry = document.getElementById('users').getElementsByClassName('user');\n            var usernames = new Array<string>();\n            for (var i=0;i<entry.length;i++) {\n                usernames.push(entry.item(i).textContent);\n            }\n            return usernames;            \n        };\n\n    }\n    var UI = new UIEntry();\n    \n    var saveUsers = (usernames) => {\n        var newusers = c.UserConstructor.createUsersByNames(usernames);\n        users.setUsers(newusers).then((result) => {\n            console.log(\"Set users\", result);\n        });\n    }\n\n    var AddUser = () => {\n        var username = UI.GetUsername();\n        if (username) {\n            var usernames = UI.GetUsers();\n            var isUnique = !(usernames.filter((value) => {\n                return value === username;\n            }).length);\n            if(isUnique) {\n                UI.AddUser(username);\n                usernames = UI.GetUsers();\n                saveUsers(usernames);\n                UI.ClearUsername();\n                setTimeout(() => { UI.FocusUsername()},10);\n            } else {\n                UI.ShowError(\"already entered user\" + username);\n            }   \n        }\n    };\n\n    users.getUsers().then((data) => {\n        UI.ClearUsers();\n        UI.FocusUsername();\n        if (data && data.length) {\n            const strings:string[] = data.map((user) => {\n                return user.name;\n            });\n            for (var i=0;i<strings.length;i++) {\n                UI.AddUser(strings[i]);\n            }\n        }\n    });\n    \n});\n\n"]}